#############################################################################
#
# ACE - Active Consistency Engine
#
# Copyright (C) 2023 - 2025, pgEdge (https://www.pgedge.com/)
#
# This software is released under the PostgreSQL License:
# https://opensource.org/license/postgresql
#
#############################################################################

default_cluster: ""

postgres:
  statement_timeout: 0       # milliseconds
  connection_timeout: 10     # seconds
  application_name: "ACE"
  tcp_keepalives_idle: 30        # seconds
  tcp_keepalives_interval: 10    # seconds
  tcp_keepalives_count: 5

table_diff:
  concurrency_factor: 1
  max_diff_rows: 1000000
  min_diff_block_size: 1
  max_diff_block_size: 1000000
  diff_block_size: 1000
  diff_batch_size: 1
  max_diff_batch_size: 1000
  compare_unit_size: 10000

mtree:
  cdc:
    slot_name: "ace_mtree_slot"
    publication_name: "ace_mtree_pub"
    cdc_processing_timeout: 30
    cdc_metadata_flush_seconds: 10
  schema: "spock"

  diff:
    min_block_size: 1000
    block_size: 100000
    max_block_size: 1000000

# Example scheduler configuration:
# schedule_jobs:
#   - name: nightly-order-check        # Unique identifier for the job
#     type: table-diff                 # Supported values: table-diff, schema-diff, repset-diff
#     cluster_name: my-cluster         # Optional; falls back to default_cluster
#     table_name: public.orders        # Use schema_name for schema-diff, repset_name for repset-diff
#     args:                            # Optional flags mirrored from the CLI
#       dbname: appdb
#       nodes: n1,n2
#       output: json
# schedule_config:
#   - job_name: nightly-order-check
#     run_frequency: 24h               # Or crontab_schedule: "0 2 * * *"
#     enabled: true
#
# Add additional entries to schedule_jobs for more tasks, and reference each by
# name from schedule_config.
server:
  listen_address: "0.0.0.0"
  listen_port: 5000
  tls_cert_file: ""
  tls_key_file: ""
  client_crl_file: ""
  allowed_common_names: []
  taskstore_path: ""

schedule_jobs: []
schedule_config: []

auto_repair_config:
  enabled: false
  cluster_name: ""
  dbname: ""
  poll_frequency: "10m"
  repair_frequency: "15m"

cert_auth:
  use_cert_auth: false
  ace_user_cert_file: "data/pg16/pki/admin-cert/admin.crt"
  ace_user_key_file:  "data/pg16/pki/admin-cert/admin.key"
  ca_cert_file:   "data/pg16/pki/ca.crt"

debug_mode: false
